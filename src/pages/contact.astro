---
import Layout from '../layouts/Layout.astro';
import Navbar from '../components/Navbar.astro';
import Footer from '../components/Footer.astro';

let message = '';

if (Astro.request.method === 'POST') {
    try {
        const data = await Astro.request.formData();
        const response = await fetch('/api/sendEmail.json', {
            method: 'POST',
            body: data,
        });
        const result = await response.json();
        message = result.message;
    } catch (error) {
        console.error(error);
        message = 'An error occurred. Please try again.';
    }
}
---

<Layout title="Contact - Get in Touch with Luke">
    <div class="flex flex-col min-h-screen">
        <Navbar/>
        <main class="flex-grow bg-blue-200 py-8 sm:py-16 overflow-y-auto border-y-4 border-black">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="bg-white border-4 border-black p-4 sm:p-8 shadow-[8px_8px_0px_0px_rgba(0,0,0,1)]">
                    <h1 class="text-3xl sm:text-4xl md:text-5xl font-bold text-black mb-4 sm:mb-8 transform -rotate-1 break-words">
                        Get in Touch</h1>

                    <p class="text-lg sm:text-xl text-black mb-8 bg-blue-100 p-4 border-4 border-black shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] inline-block transform rotate-1">
                        Ready to bring your app idea to life? I'm here to help! Fill out the form below, and I'll get
                        back to you as soon as possible to discuss your project.
                    </p>

                    <div class="flex flex-col sm:flex-row gap-4 mb-8">
                        <a href="mailto:get@appsbyluke.com"
                           class="bg-green-400 hover:bg-green-500 text-black hover:text-white font-bold py-3 px-6 border-4 border-black shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] hover:shadow-[2px_2px_0px_0px_rgba(0,0,0,1)] transition-all duration-300 transform hover:-rotate-1 inline-block text-center">
                            Email Directly
                        </a>
                        <a href="https://calendar.app.google/uDz6rZrYgUxqAC2i9" target="_blank"
                           class="bg-yellow-400 hover:bg-yellow-500 text-black hover:text-white font-bold py-3 px-6 border-4 border-black shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] hover:shadow-[2px_2px_0px_0px_rgba(0,0,0,1)] transition-all duration-300 transform hover:rotate-1 inline-block text-center">
                            Book Intro Call
                        </a>
                    </div>

                    {message && <p class="mb-4 text-lg font-bold">{message}</p>}

                    <form method="POST" class="space-y-6">
                        <div>
                            <label for="name" class="block text-lg font-bold text-black">Name</label>
                            <input type="text" id="name" name="name" required
                                   class="mt-1 block w-full border-4 border-black shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] py-2 px-3 focus:outline-none focus:bg-pink-200 bg-white transition-colors duration-300">
                        </div>
                        <div>
                            <label for="email" class="block text-lg font-bold text-black">Email</label>
                            <input type="email" id="email" name="email" required
                                   class="mt-1 block w-full border-4 border-black shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] py-2 px-3 focus:outline-none focus:bg-pink-200 bg-white transition-colors duration-300">
                        </div>
                        <div>
                            <label for="message" class="block text-lg font-bold text-black">Message</label>
                            <textarea id="message" name="message" rows="4" required
                                      class="mt-1 block w-full border-4 border-black shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] py-2 px-3 focus:outline-none focus:bg-pink-200 bg-white transition-colors duration-300"></textarea>
                        </div>
                        <div>
                            <button type="submit"
                                    class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-6 border-4 border-black shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] hover:shadow-[2px_2px_0px_0px_rgba(0,0,0,1)] transition-all duration-300 transform hover:rotate-1">
                                Send Message
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </main>
        <Footer/>
    </div>
</Layout>